<!DOCTYPE html>
<head>
    <meta charset="UTF-8">

    <title>某疫情全国地图</title>
    <script src="https://www.echartsjs.com/examples/vendors/jquery/jquery.js"></script>
    <!-- 引入 echarts.js -->
    <script src="https://www.echartsjs.com/examples/vendors/echarts/echarts.min.js?_v_=1578305236132"></script>
    <!--引入中国的地图数据js文件-->
    <script src="https://www.echartsjs.com/examples/vendors/echarts/map/js/china.js?_v_=1578305236132"></script>

</head>


<style>
    .container 
    {
        width: 1200px;
        margin: 0 auto;
    }

    #echartsMainMap
    {
        width: 800px;
        height: 500px;
        margin: 0 auto;
        background-color:rgba(255, 235, 205, 0.322);
    }

    #echartsMainLine
    {
        width: 800px;
        height: 500px;
        margin: 0 auto;
        background-color:rgba(255, 235, 205, 0.322);
    }
    
    footer
    {
        color:gray;
        font-size:10px;
        text-align:center;
    }
</style>

<body>
    <div class="container">
        <div id="echartsMainMap"></div>
        <br/><br/><br/>
        <div id="echartsMainLine"></div>
    </div>
</body>

<script>
        //地图部分
        var myChart = echarts.init(document.getElementById("echartsMainMap"));
        var option = {
                        title : {
                            text: '中国某疫情统计地图',
                            subtext: '点击省份可以查看详情',
                            x:'center'
                        },
                        tooltip : {
                            trigger: 'item'
                        },
                        legend: {
                            orient: 'vertical',
                            x:'left',
                            data:['确诊人数']
                        },
                        dataRange: {
                            x: 'left',
                            y: 'bottom',
                            splitList: [
                                {start: 200,color:'RGB(134,1,26)'},
                                {start: 100, end: 200,color:'RGB(224,46,79)'},
                                {start: 30, end: 100,color:'RGB(224,91,115)'},
                                {start: 20, end: 30,color:'RGB(224,113,134)'},
                                {start: 10, end: 20,color:'RGB(224,157,170)'},
                                {start: 5, end: 10,color:'RGB(224,180,188)'},
                                {end: 5,color:'RGB(224,224,224)'}
                            ],
                            
                        },
                        toolbox: {
                            show: true,
                            orient : 'vertical',
                            x: 'right',
                            y: 'center',
                            feature : {
                                mark : {show: true},
                                dataView : {show: true, readOnly: false},
                                restore : {show: true},
                                saveAsImage : {show: false}
                            }
                        },
                        roamController: {
                            show: false,
                            x: 'right',
                            mapTypeControl: {
                                'china': true
                            }
                        },
                        series : [
                            {
                                name: '确诊人数',
                                type: 'map',
                                mapType: 'china',
                                roam: false,
                                itemStyle:{
                                    normal:{
                                        label:{
                                            show:true,
                                            textStyle: {
                                            color: "rgb(249, 249, 249)"
                                            }
                                        }
                                    },
                                    emphasis:{label:{show:true}}
                                },
                                data:[]
                            }
                        ]
                    };

        myChart.setOption(option);

        //获取数据
        function getData() {
        $.ajax({
            url: "https://view.inews.qq.com/g2/getOnsInfo?name=disease_h5",
            dataType: "jsonp",
            success: function (data) {
            //  console.log(data.data)
            var res = data.data || "";
            res = JSON.parse(res);
            var newArr = [];
            //newArr的数据格式为：
            // [{
            //   name: '北京11',
            //   value: 212
            // }, {
            //   name: '天津',
            //   value: 60
            // }]
            if (res) {
                //获取到各个省份的数据
                var province = res.areaTree[0].children;
                for (var i = 0; i < province.length; i++) {
                var json = {
                    name: province[i].name,
                    value: province[i].total.confirm-province[i].total.dead-province[i].total.heal-province[i].total.suspect
                }
                newArr.push(json)
                }
                console.log(newArr)
                console.log(JSON.stringify(newArr))
                //使用指定的配置项和数据显示图表
                myChart.setOption({
                series: [
                    {
                    name: '确诊数',
                    type: 'map',
                    mapType: 'china',
                    roam: false,
                    label: {
                        show: true,
                        color: 'rgb(249, 249, 249)'
                    },
                    data: newArr
                    }
                ]
                });
            }
            }

        })
        }
        getData();

        myChart.on('click', function(params){
                    console.log(params); 
                    var name = params.name;
                    window.location.href="https://www.baidu.com/";
                });




        //折线图部分
        var myChart2 = echarts.init(document.getElementById('echartsMainLine'));
        var option = {
        title : {
            text: '中国某疫情人数折线图',
            subtext: '数据随机生成，纯属虚构',
            x:'center'
        },
        tooltip : {
            trigger: 'axis'
        },
        legend: {
            x:'right',
            data:['现有确诊','现有疑似','累计治愈']
        },
        toolbox: {
            orient : 'vertical',
            x: 'right',
            y: 'center',
            show : true,
            feature : {
                mark : {show: true},
                dataView : {show: true, readOnly: false},
                magicType : {show: false, type: ['line', 'bar']},
                restore : {show: true},
                saveAsImage : {show: false}
            }
        },
        calculable : true,
        xAxis : [
            {
                type : 'category',
                boundaryGap : false,
                data : ['2.20','2.21','2.22','2.23','2.24','2.25','2.26']
            }
        ],
        yAxis : [
            {
                type : 'value',
                axisLabel : {
                    formatter: '{value} 人'
                }
            }
        ],
        series : [
            {
                name:'现有确诊',
                type:'line',
                data:[
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000)],
            },
            {
                name:'现有疑似',
                type:'line',
                data:[
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000)],
            },
            {
                name:'累计治愈',
                type:'line',
                data:[
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000), 
                        Math.round(Math.random()*2000)],
            }
        ]
    };
    myChart2.setOption(option);



</script>

    <br/><br/><br/>

    <footer>
        Copyright@221701201 221701202.All Rights Reserved.
    </footer>

</html>
